<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <center>
  <img src="logo.png" width="200px">
  <title>Formulaire d'enregistrement</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f9;
      padding: 20px;
    }
    .form-container {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      margin-bottom: 20px;
      max-width: 500px;
    }
    .form-container h2 {
      text-align: center;
      margin-bottom: 15px;
    }
    label { display:block; margin-top:10px; font-weight:bold; }
    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    .btn {
      margin-top: 15px;
      padding: 10px;
      width: 100%;
      background: #0073e6;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
    }
    .btn:hover { background:#005bb5; }
  </style>
</head>
<body>

  <div class="form-container">
    <h2>Formulaire d'enregistrement</h2>

    <label>Nom(s) :</label>
    <input type="text" id="nom" required>

    <label>Prénom(s) :</label>
    <input type="text" id="prenom" required>

    <label>Statut :</label>
    <select id="statut">
      <option>Membre</option>
      <option>Président(e)</option>
      <option>Vice-Président(e)</option>
      <option>Secrétaire Général(e)</option>
      <option>Trésorier(e)</option>
      <option>Commissaire aux comptes</option>
      <option>Responsable Communication</option>
      <option>Responsable Juridique</option>
      <option>Responsable Culture</option>
    </select>

    <label>Profession :</label>
    <input type="text" id="profession">

    <label>Photo d’identité :</label>
    <input type="file" id="photo" accept="image/*">

    <button class="btn" onclick="genererCarte()">Générer la carte (nouvel onglet)</button>
  </div>

  <script>
    // Helper: lit un fichier en DataURL (promesse)
    function fileToDataURL(file) {
      return new Promise((resolve) => {
        if (!file) return resolve(null);
        const reader = new FileReader();
        reader.onload = e => resolve(e.target.result);
        reader.readAsDataURL(file);
      });
    }

    async function genererCarte() {
      const nom = document.getElementById("nom").value.trim();
      const prenom = document.getElementById("prenom").value.trim();
      const statut = document.getElementById("statut").value;
      const profession = document.getElementById("profession").value.trim();
      const dateAdhesion = new Date().toLocaleDateString("fr-FR");

      // Photo en base64 si fournie (sinon null)
      const file = document.getElementById("photo").files[0];
      const photoDataURL = await fileToDataURL(file);

      // Ouvre le nouvel onglet
      const w = window.open("", "_blank");
      if (!w) {
        alert("Le navigateur a bloqué l'ouverture du nouvel onglet. Autorisez les pop-ups pour ce site.");
        return;
      }

      // HTML de la carte dans le nouvel onglet
      const html = `
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Carte de membre</title>
<base href="${document.baseURI}"> <!-- permet à 'logo.png' d'être résolu depuis le même dossier -->
<style>
  html, body { margin:0; padding:0; background:#f4f4f9; font-family: Arial, sans-serif; }
  .page { display:flex; justify-content:center; padding:24px; }
  .card {
    width: 500px;
    background:#fff;
    border:2px solid #000;
    border-radius:12px;
    box-shadow: 0 2px 6px rgba(0,0,0,.2);
    position:relative;
    padding:20px;
    box-sizing:border-box;
  }
  .logo {
    position:absolute; top:10px; left:10px; width:100px;
  }
  h2 { text-align:center; margin:0 0 15px 0; }
  .card-content {
    display:flex; justify-content:space-between; align-items:center; /* centre verticalement la photo */
    margin-top:40px; /* espace sous le logo */
  }
  .card-info { flex:1; padding-right:20px; }
  .card-info p { margin:6px 0; }
  .photo {
    width:120px; height:150px; border:1px solid #000; background:#eaeaea;
    display:flex; align-items:center; justify-content:center; font-size:12px; color:#555;
    background-size:cover; background-position:center;
  }
  .toolbar {
    display:flex; gap:8px; justify-content:flex-end; margin:12px 0 0 0;
  }
  .toolbar button { padding:8px 12px; border-radius:6px; border:none; cursor:pointer; }
  .print { background:#0073e6; color:#fff; }
  .print:hover { background:#005bb5; }
  @media print {
    body { background:#fff; }
    .toolbar { display:none; }
    .page { padding:0; }
    .card { box-shadow:none; margin:0; }
  }
</style>
</head>
<body>
    <br><br><br><br><br><br><br><br><br><br>
  <div class="page">
    
    <div class="card" id="carte">
      <img src="logo.png" class="logo" alt="Logo">
      <h2>CARTE DE MEMBRE<br>MANDAT 2025 – 2026</h2>
      <div class="card-content">
        <div class="card-info">
          <p><strong>Nom(s) :</strong> ${nom || "-"}</p>
          <p><strong>Prénom(s) :</strong> ${prenom || "-"}</p>
          <p><strong>Statut :</strong> ${statut}</p>
          <p><strong>Profession :</strong> ${profession || "-"}</p>
          <p><strong>Date d’adhésion :</strong> ${dateAdhesion}</p>
          <p><strong>Valide jusqu’au :</strong> 31/08/2026</p>
        </div>
        <div class="photo" id="photoSlot" ${photoDataURL ? `style="background-image:url('${photoDataURL}');"` : ""}>${photoDataURL ? "" : "Photo"}</div>
      </div>

      <div class="toolbar">
        <button class="print" onclick="window.print()">Imprimer / Enregistrer en PDF</button>
      </div>
    </div>
  </div>
  <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
</body>
</html>`;

      w.document.open();
      w.document.write(html);
      w.document.close();
    }
  </script>

</body>
</html>
